{% extends "base.html" %}

{% block title %}Professional Directory - ConnectHub{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <h1 class="text-4xl font-bold text-gray-800 mb-8">Professional Directory</h1>
    
    <!-- Search and Filter -->
    <div class="bg-white rounded-xl shadow-md p-6 mb-8">
        <form method="get" class="flex flex-col md:flex-row gap-4">
            <div class="flex-1">
                <input 
                    type="text" 
                    name="search" 
                    placeholder="Search professionals by name, headline..." 
                    value="{{ search or '' }}"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"
                >
            </div>
            <div>
                <input 
                    type="text" 
                    name="skill" 
                    placeholder="Filter by skill..." 
                    value="{{ skill or '' }}"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"
                >
            </div>
            <button 
                type="submit" 
                class="px-6 py-3 gradient-bg text-white rounded-lg hover:opacity-90 transition"
            >
                Search
            </button>
        </form>
        
        {% if user %}
        <div class="mt-4">
            <a 
                href="/dashboard/profile/edit" 
                class="text-purple-600 hover:text-purple-800 font-medium"
            >
                + Create Your Profile
            </a>
        </div>
        {% endif %}
    </div>
    
    <!-- Results -->
    <div class="mb-4">
        <p class="text-gray-600">{{ total }} professional{{ 's' if total != 1 else '' }} found</p>
    </div>
    
    {% if professionals %}
    <!-- Professional Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        {% for professional in professionals %}
        <div class="bg-white rounded-xl shadow-md p-6 text-center card-hover">
            {% if professional.user.profile_picture_url %}
            <img 
                src="{{ professional.user.profile_picture_url }}" 
                alt="{{ professional.full_name }}" 
                class="w-20 h-20 rounded-full mx-auto mb-4"
            >
            {% else %}
            <div class="w-20 h-20 rounded-full bg-gradient-to-br from-purple-400 to-blue-500 mx-auto mb-4 flex items-center justify-center text-white text-2xl font-bold">
                {{ professional.full_name[0] }}
            </div>
            {% endif %}
            <h3 class="text-lg font-bold text-gray-800 mb-1">{{ professional.full_name }}</h3>
            <p class="text-sm text-gray-600 mb-3">{{ professional.headline }}</p>
            
            {% if professional.skills %}
            <div class="flex flex-wrap gap-1 justify-center mb-4">
                {% for skill in professional.skills[:3] %}
                <span class="px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs">{{ skill }}</span>
                {% endfor %}
                {% if professional.skills|length > 3 %}
                <span class="px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs">+{{ professional.skills|length - 3 }}</span>
                {% endif %}
            </div>
            {% endif %}
            
            <a 
                href="/profile/{{ professional.slug }}" 
                class="text-purple-600 hover:text-purple-800 font-medium text-sm inline-block"
            >
                View Profile →
            </a>
        </div>
        {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if total_pages > 1 %}
    <div class="flex justify-center gap-2">
        {% if page > 1 %}
        <a 
            href="?page={{ page - 1 }}{% if search %}&search={{ search }}{% endif %}{% if skill %}&skill={{ skill }}{% endif %}" 
            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"
        >
            Previous
        </a>
        {% endif %}
        
        {% for p in range(1, total_pages + 1) %}
        {% if p == page %}
        <span class="px-4 py-2 bg-purple-600 text-white rounded-lg">{{ p }}</span>
        {% elif p == 1 or p == total_pages or (p >= page - 2 and p <= page + 2) %}
        <a 
            href="?page={{ p }}{% if search %}&search={{ search }}{% endif %}{% if skill %}&skill={{ skill }}{% endif %}" 
            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"
        >
            {{ p }}
        </a>
        {% elif p == page - 3 or p == page + 3 %}
        <span class="px-4 py-2">...</span>
        {% endif %}
        {% endfor %}
        
        {% if page < total_pages %}
        <a 
            href="?page={{ page + 1 }}{% if search %}&search={{ search }}{% endif %}{% if skill %}&skill={{ skill }}{% endif %}" 
            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"
        >
            Next
        </a>
        {% endif %}
    </div>
    {% endif %}
    {% else %}
    <div class="bg-white rounded-xl shadow-md p-12 text-center">
        <p class="text-gray-600 text-lg mb-4">No professionals found.</p>
        {% if user %}
        <a href="/dashboard/profile/edit" class="text-purple-600 hover:text-purple-800 font-medium">
            Create the first profile →
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}

